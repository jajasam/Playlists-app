{"ast":null,"code":"import _slicedToArray from\"/Users/janasamson/Desktop/Music App/app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from\"react\";import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";function useAuth(code){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),accessToken=_useState2[0],setAccessToken=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),refreshToken=_useState4[0],setRefreshToken=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),expiresIn=_useState6[0],setExpiresIn=_useState6[1];useEffect(function(){axios.post(\"http://localhost:3001/login\",{code:code}).then(function(res){console.log(res.data);setAccessToken(res.data.accessToken);setRefreshToken(res.data.refreshToken);setExpiresIn(res.data.expiresIn);}).catch(function(err){window.location='';});},[]);useEffect(function(){if(!refreshToken||!expiresIn)return;var interval=setInterval(function(){axios.post(\"http://localhost:3001/refresh\",{refreshToken:refreshToken}).then(function(res){console.log('refreshed');setAccessToken(res.data.accessToken);setExpiresIn(res.data.expiresIn);}).catch(function(err){window.location='';});},(expiresIn-60)*1000);return function(){return clearInterval(interval);};},[accessToken,expiresIn]);return/*#__PURE__*/_jsx(\"div\",{children:\"test\"});}export default useAuth;","map":{"version":3,"names":["useState","useEffect","axios","useAuth","code","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","post","then","res","console","log","data","catch","err","window","location","interval","setInterval","clearInterval"],"sources":["/Users/janasamson/Desktop/Music App/app/client/src/useAuth.js"],"sourcesContent":["import { useState, useEffect } from \"react\"\nimport axios from 'axios'\n\nfunction useAuth(code) {\n    const [accessToken, setAccessToken] = useState(\"\")\n    const [refreshToken, setRefreshToken] = useState(\"\")\n    const [expiresIn, setExpiresIn] = useState(\"\")\n\n    useEffect(() => {\n        axios.post(\"http://localhost:3001/login\", {\n            code,\n        }).then(res => {\n            console.log(res.data)\n            setAccessToken(res.data.accessToken)\n            setRefreshToken(res.data.refreshToken)\n            setExpiresIn(res.data.expiresIn)\n        }).catch(err => {\n            window.location = ''\n        })\n    }, [])\n\n    useEffect(() => {\n        if (!refreshToken || !expiresIn) return;\n\n        const interval = setInterval(() => {\n            axios.post(\"http://localhost:3001/refresh\", {\n            refreshToken\n            })\n            .then(res => {\n                console.log('refreshed')\n                setAccessToken(res.data.accessToken)\n                setExpiresIn(res.data.expiresIn)\n            }).catch(err => {\n                window.location = ''\n            })\n        }, (expiresIn - 60) * 1000)\n\n        return () => clearInterval(interval)\n        \n    }, [accessToken, expiresIn])\n\n    return (\n        <div>\n            test\n        </div>\n    )\n}\n\nexport default useAuth\n"],"mappings":"oIAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAOC,MAAK,KAAM,OAAO,4CAEzB,QAASC,QAAO,CAACC,IAAI,CAAE,CACnB,cAAsCJ,QAAQ,CAAC,EAAE,CAAC,wCAA3CK,WAAW,eAAEC,cAAc,eAClC,eAAwCN,QAAQ,CAAC,EAAE,CAAC,yCAA7CO,YAAY,eAAEC,eAAe,eACpC,eAAkCR,QAAQ,CAAC,EAAE,CAAC,yCAAvCS,SAAS,eAAEC,YAAY,eAE9BT,SAAS,CAAC,UAAM,CACZC,KAAK,CAACS,IAAI,CAAC,6BAA6B,CAAE,CACtCP,IAAI,CAAJA,IACJ,CAAC,CAAC,CAACQ,IAAI,CAAC,SAAAC,GAAG,CAAI,CACXC,OAAO,CAACC,GAAG,CAACF,GAAG,CAACG,IAAI,CAAC,CACrBV,cAAc,CAACO,GAAG,CAACG,IAAI,CAACX,WAAW,CAAC,CACpCG,eAAe,CAACK,GAAG,CAACG,IAAI,CAACT,YAAY,CAAC,CACtCG,YAAY,CAACG,GAAG,CAACG,IAAI,CAACP,SAAS,CAAC,CACpC,CAAC,CAAC,CAACQ,KAAK,CAAC,SAAAC,GAAG,CAAI,CACZC,MAAM,CAACC,QAAQ,CAAG,EAAE,CACxB,CAAC,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAENnB,SAAS,CAAC,UAAM,CACZ,GAAI,CAACM,YAAY,EAAI,CAACE,SAAS,CAAE,OAEjC,GAAMY,SAAQ,CAAGC,WAAW,CAAC,UAAM,CAC/BpB,KAAK,CAACS,IAAI,CAAC,+BAA+B,CAAE,CAC5CJ,YAAY,CAAZA,YACA,CAAC,CAAC,CACDK,IAAI,CAAC,SAAAC,GAAG,CAAI,CACTC,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC,CACxBT,cAAc,CAACO,GAAG,CAACG,IAAI,CAACX,WAAW,CAAC,CACpCK,YAAY,CAACG,GAAG,CAACG,IAAI,CAACP,SAAS,CAAC,CACpC,CAAC,CAAC,CAACQ,KAAK,CAAC,SAAAC,GAAG,CAAI,CACZC,MAAM,CAACC,QAAQ,CAAG,EAAE,CACxB,CAAC,CAAC,CACN,CAAC,CAAE,CAACX,SAAS,CAAG,EAAE,EAAI,IAAI,CAAC,CAE3B,MAAO,kBAAMc,cAAa,CAACF,QAAQ,CAAC,GAExC,CAAC,CAAE,CAAChB,WAAW,CAAEI,SAAS,CAAC,CAAC,CAE5B,mBACI,6BAEM,CAEd,CAEA,cAAeN,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}